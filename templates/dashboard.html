{% extends 'base/base.html' %}

{% block title %}Dashboard - Fisioterapia Clinic{% endblock %}

{% block page_title %}Panel de Control{% endblock %}

{% block content %}
<div class="container-fluid px-0">
    <!-- Estadísticas principales -->
    <div class="row g-2 g-md-3 mb-4">
        <div class="col-3 col-md-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-2 p-md-3 text-center">
                    <div class="stat-icon mb-2">
                        <i class="fas fa-users"></i>
                    </div>
                    <h6 class="text-muted mb-2 stat-title">Total<br class="d-md-none"> Pacientes</h6>
                    <h3 class="mb-0 stat-value">{{ total_pacientes|default:0 }}</h3>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-2 p-md-3 text-center">
                    <div class="stat-icon stat-icon-success mb-2">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <h6 class="text-muted mb-2 stat-title">Citas<br class="d-md-none"> Próximas</h6>
                    <h3 class="mb-0 stat-value">{{ total_citas|default:0 }}</h3>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-2 p-md-3 text-center">
                    <div class="stat-icon stat-icon-warning mb-2">
                        <i class="fas fa-file-medical"></i>
                    </div>
                    <h6 class="text-muted mb-2 stat-title">Historias<br class="d-md-none"> Clínicas</h6>
                    <h3 class="mb-0 stat-value">{{ total_historias|default:0 }}</h3>
                </div>
            </div>
        </div>

        <div class="col-3 col-md-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body p-2 p-md-3 text-center">
                    <div class="stat-icon stat-icon-danger mb-2">
                        <i class="fas fa-spa"></i>
                    </div>
                    <h6 class="text-muted mb-2 stat-title">Tratamientos<br class="d-md-none"> Activos</h6>
                    <h3 class="mb-0 stat-value">{{ total_tratamientos|default:0 }}</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Bienvenida -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-body p-3 p-md-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="mb-2">Bienvenida, {{ user.get_full_name|default:user.username }}!</h4>
                            <p class="text-muted mb-0 small">
                                Sistema de gestión integral para clínica de fisioterapia. 
                                Aquí puede administrar pacientes, citas, historias clínicas y tratamientos estéticos.
                            </p>
                        </div>
                        <div class="col-md-4 text-center d-none d-md-block">
                            <i class="fas fa-handshake" style="font-size: 60px; color: #0d6efd; opacity: 0.2;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Acciones rápidas -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="fas fa-bolt"></i> Acciones Rápidas</h5>
                </div>
                <div class="card-body p-3">
                    <div class="quick-actions">
                        <a href="{% url 'pacientes:crear' %}" class="btn btn-primary">
                            <i class="fas fa-user-plus"></i> 
                            <span class="d-none d-sm-inline">Nuevo Paciente</span>
                            <span class="d-inline d-sm-none">Paciente</span>
                        </a>
                        <a href="{% url 'citas:crear' %}" class="btn btn-success">
                            <i class="fas fa-calendar-plus"></i> 
                            <span class="d-none d-sm-inline">Agendar Cita</span>
                            <span class="d-inline d-sm-none">Cita</span>
                        </a>
                        <a href="{% url 'tratamientos:crear' %}" class="btn btn-danger">
                            <i class="fas fa-plus-circle"></i> 
                            <span class="d-none d-sm-inline">Nuevo Tratamiento</span>
                            <span class="d-inline d-sm-none">Tratamiento</span>
                        </a>
                        <a href="{% url 'citas:terapeutas' %}" class="btn btn-warning">
                            <i class="fas fa-users-cog"></i> 
                            <span class="d-none d-sm-inline">Gestionar Terapeutas</span>
                            <span class="d-inline d-sm-none">Terapeutas</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Secciones -->
    <div class="row g-3">
        <div class="col-12 col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-light d-flex justify-content-between align-items-center p-3">
                    <h5 class="mb-0 fs-6">
                        <i class="fas fa-users"></i> Gestión de Pacientes
                    </h5>
                    <a href="{% url 'pacientes:lista' %}" class="btn btn-sm btn-outline-primary">Ver todos</a>
                </div>
                <div class="card-body p-3">
                    <p class="text-muted small mb-3">Administre información de pacientes, antecedentes médicos y datos nutricionales.</p>
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2"><a href="{% url 'pacientes:crear' %}" class="text-decoration-none"><i class="fas fa-plus-circle text-primary me-1"></i> Registrar nuevo paciente</a></li>
                        <li><a href="{% url 'pacientes:lista' %}" class="text-decoration-none"><i class="fas fa-list text-primary me-1"></i> Listar todos los pacientes</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-light d-flex justify-content-between align-items-center p-3">
                    <h5 class="mb-0 fs-6">
                        <i class="fas fa-calendar"></i> Gestión de Citas
                    </h5>
                    <a href="{% url 'citas:lista' %}" class="btn btn-sm btn-outline-primary">Ver todos</a>
                </div>
                <div class="card-body p-3">
                    <p class="text-muted small mb-3">Programe citas, vea disponibilidad y administre terapeutas.</p>
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2"><a href="{% url 'citas:crear' %}" class="text-decoration-none"><i class="fas fa-plus-circle text-success me-1"></i> Agendar nueva cita</a></li>
                        <li class="mb-2"><a href="{% url 'citas:proximas' %}" class="text-decoration-none"><i class="fas fa-calendar-alt text-success me-1"></i> Ver citas próximas</a></li>
                        <li><a href="{% url 'citas:terapeutas' %}" class="text-decoration-none"><i class="fas fa-users-cog text-success me-1"></i> Gestionar terapeutas</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-light d-flex justify-content-between align-items-center p-3">
                    <h5 class="mb-0 fs-6">
                        <i class="fas fa-file-medical"></i> Historias Clínicas
                    </h5>
                    <a href="{% url 'historiaclinica:lista' %}" class="btn btn-sm btn-outline-primary">Ver todos</a>
                </div>
                <div class="card-body p-3">
                    <p class="text-muted small mb-3">Registre diagnósticos, ejercicios terapéuticos y evoluciones.</p>
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2"><a href="{% url 'historiaclinica:lista' %}" class="text-decoration-none"><i class="fas fa-list text-warning me-1"></i> Listar historias clínicas</a></li>
                        <li><a href="{% url 'pacientes:lista' %}" class="text-decoration-none"><i class="fas fa-plus-circle text-warning me-1"></i> Crear historia para paciente</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-12 col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-light d-flex justify-content-between align-items-center p-3">
                    <h5 class="mb-0 fs-6">
                        <i class="fas fa-spa"></i> Tratamientos Estéticos
                    </h5>
                    <a href="{% url 'tratamientos:lista' %}" class="btn btn-sm btn-outline-primary">Ver todos</a>
                </div>
                <div class="card-body p-3">
                    <p class="text-muted small mb-3">Administre tratamientos estéticos, medidas y evoluciones.</p>
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2"><a href="{% url 'tratamientos:crear' %}" class="text-decoration-none"><i class="fas fa-plus-circle text-danger me-1"></i> Crear nuevo tratamiento</a></li>
                        <li><a href="{% url 'tratamientos:lista' %}" class="text-decoration-none"><i class="fas fa-list text-danger me-1"></i> Ver todos los tratamientos</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    /* Ajuste de padding para móvil */
    @media (max-width: 768px) {
        .content-area {
            padding: 4px 1px !important;
        }
        .quick-actions .btn {
            font-size: 13px;
            padding: 4px 1px !important;
        }
        .welcome-card p {
            font-size: 12px !important;
            padding: 0 !important;
        }
        
        .container-fluid {
            padding-left: 0 !important;
            padding-right: 0 !important;
        }
    }

    /* Iconos de estadísticas */
    .stat-icon {
        font-size: 32px;
        color: #0d6efd;
        opacity: 0.8;
    }

    .stat-icon-success {
        color: #198754;
    }

    .stat-icon-warning {
        color: #ffc107;
    }

    .stat-icon-danger {
        color: #dc3545;
    }

    @media (max-width: 768px) {
        .stat-icon {
            font-size: 18px;
        }
    }

    /* Cards de estadísticas */
    .stat-title {
        font-size: 14px;
        line-height: 1.3;
    }

    .stat-value {
        font-size: 28px;
        font-weight: 600;
        color: #0d6efd;
    }

    @media (max-width: 768px) {
        /* Reducir altura de las cards en móvil */
        .row.g-2 .card {
            min-height: 30px;
        }

        .row.g-2 .card-body {
            padding: 0.5rem !important;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .stat-title {
            font-size: 10px;
            line-height: 1.1;
            margin-bottom: 0.2rem !important;
        }
        
        .stat-value {
            font-size: 18px;
            margin-bottom: 0 !important;
        }

        .stat-icon {
            font-size: 18px;
            margin-bottom: 0.2rem !important;
        }
    }

    @media (max-width: 480px) {
        /* Altura aún más reducida en pantallas muy pequeñas */
        .row.g-2 .card {
            min-height: 20px;
        }

        .stat-title {
            font-size: 9px;
            line-height: 1;
        }
        
        .stat-value {
            font-size: 16px;
        }

        .stat-icon {
            font-size: 16px;
        }
    }

    /* Acciones rápidas */
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
    }

    @media (max-width: 576px) {
        .quick-actions {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .quick-actions .btn {
            font-size: 13px;
            padding: 5px 4px;
        }
    }

    /* Headers de cards */
    .card-header {
        border-bottom: 2px solid #f0f0f0;
    }

    @media (max-width: 768px) {
        .card-header h5 {
            font-size: 14px;
        }
        
        .card-header .btn-sm {
            font-size: 11px;
            padding: 2px 4px;
        }
    }

    /* Espaciado entre filas */
    .row.g-3 {
        --bs-gutter-x: 0.75rem;
        --bs-gutter-y: 0.75rem;
    }

    @media (max-width: 768px) {
        .row.g-3 {
            --bs-gutter-x: 0.5rem;
            --bs-gutter-y: 0.5rem;
        }
    }

    /* Enlaces en listas */
    .list-unstyled a {
        transition: all 0.2s ease;
    }

    .list-unstyled a:hover {
        color: #0d6efd !important;
        transform: translateX(3px);
        display: inline-block;
    }

    /* Responsive de altura de cards */
    @media (min-width: 769px) {
        .h-100 {
            height: 100% !important;
        }
    }
</style>
{% endblock %}